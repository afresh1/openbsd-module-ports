#!/bin/sh
BINDIR=$( readlink -f $(dirname $0) )

PORTSDIR_PATH=$( make show=PORTSDIR_PATH | tr ':' "\n" |
    awk '{ print length(), $0 | "sort -rn" }' |
    sed -e 's/^[0-9]* //' )

PKGPATH=$( make show=BASE_PKGPATH )

diff=""
for d in $PORTSDIR_PATH; do
	cd $d/$PKGPATH
	$BINDIR/test_reverse
	diff="$d/$PKGPATH/reverse_depends_results $diff"
done

echo diff -u $diff
